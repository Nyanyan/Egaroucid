# 英訳・更新の手順

`ja`フォルダ内のファイルを英訳、または更新する際は、以下の手順に従ってください。

## 既存ファイルの翻訳・更新
対応するファイルが`en`フォルダに**すでに存在する場合**は、こちらの更新手順に従います。これは、単純な「翻訳」の依頼であっても同様です。

1. `ja`フォルダ内の変更されたファイルを読み込みます。
2. **必ず`git`コマンドを使い、前回の翻訳時から変更された箇所のみを特定します。**
   これにより、作業範囲を正確に把握し、不要な翻訳を防ぎます。
   1. `git log -n 1 --pretty=format:%H -- <enフォルダのファイルパス>` で、`en`側ファイルの最終更新コミットIDを取得します。
      1. このとき、geminiを実行しているのがresourcesディレクトリであることに注意してください。つまり、enフォルダのパスにはen以降のパスを入力します。
   2. `git diff <取得したコミットID> -- <jaフォルダのファイルパス>` で、`ja`側ファイルの変更差分（翻訳対象）を取得します。
      1. こちらでも同様に、jaフォルダ以降のパスを入力します。
3. 上記差分のみを翻訳し、`en`フォルダの該当ファイルに反映させます。

## 新規ファイルの翻訳
対応するファイルが`en`フォルダに存在しない場合は、`ja`フォルダのファイルを全文翻訳し、`en`フォルダ内の対応するパスに新規ファイルとして保存します。

### 注意事項
Geminiが完全に英訳した記事には、**必ず「This page is a machine translation of the Japanese version. Please refer to the Japanese version for the official content.」**と記してください。
- この注意書きは太字で書いてください。
- この注意書きは各記事のタイトル(h1タグ、`#`1つで始まる行)の直後に書いてください。
- 「日本語版」という文字のところに日本語版へのリンク(URLのうち、"en"を"ja"に変更したもの)を貼ってください。ただし、リンクのうちindex.mdの部分は必要ありません。

## 共通事項
- 画像など翻訳が不要なファイルは、`ja`フォルダから`en`フォルダへ、同じディレクトリ構成を維持してそのままコピーします。
- 新たにフォルダを作成した場合は、その親ディレクトリの`tasks.txt`を確認し、記載がなければ先頭行に新しいフォルダ名を追加します。この操作は`ja`と`en`の両方の`tasks.txt`に対して行います。
- web_resources/ja/usageフォルダ内の文書を英訳するときは、以下のファイルを参照し、日英の翻訳の対応として使ってください
  - `bin\resources\languages\english.json`
  - `bin\resources\languages\japanese.json`
- 論文の引用を行っている場合、論文タイトル・著者・ジャーナル等が正しく翻訳されているかをWeb検索で確認してください。
  - 日本語のタイトル等で検索し、英訳版タイトル等が公になっていれば、それを使ってください。
  - もし日本語版タイトル等(またはほかの言語のタイトル等)しか存在しなければ、もとの言語のタイトル等を使ってください。

## Tips & トラブルシューティング
- **文字化け対策 (Windows環境)**: `run_shell_command` で `cat` や `git diff` を使用すると、UTF-8の日本語ファイルが文字化けすることがあります。
  - ファイル内容の読み出しには `read_file` ツールを優先して使用してください。
  - `git diff` で差分を確認する際、日本語部分が読めない場合は、変更前後の行番号や英数字（リンク、バージョン番号など）をヒントに `read_file` で該当箇所を読み直して内容を確認してください。
- **PowerShellコマンドの互換性**: Windows環境では `head` や `tail` などのUnixコマンドが標準で使えない場合があります。
  - 代わりに `Select-Object -First <n>` や `Select-Object -Last <n>` を使うか、出力が短い場合は何も指定せずに全出力を確認してください。
- **調査範囲の最小化**: プロジェクト全体の共通ルール（翻訳免責事項の要否など）を確認するために他ファイルを参照する場合、ユーザーから「関係ないファイルを読んでいる」と誤解される可能性があります。意図をあらかじめ説明するか、可能な限り対象ファイル内の確認に留めてください。
