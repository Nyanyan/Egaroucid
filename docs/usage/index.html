<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        <script id="twitter-wjs" src="https://platform.twitter.com/widgets.js"></script>
        <link rel="stylesheet" href="assets/css/style.css">
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="@takuto_yamana" />
        <meta property="og:url" content="https://www.egaroucid.nyanyan.dev" />
        <meta property="og:title" content="オセロ研究支援AIアプリ Egaroucid 使い方" />
        <meta property="og:description" content="世界最強クラスのオセロAI搭載のオセロ研究支援アプリ" />
        <meta property="og:image" content="https://raw.githubusercontent.com/Nyanyan/Egaroucid_Web_Ver/master/docs/img.png" />
        <title>オセロ研究支援AIアプリ Egaroucid</title>
    </head>
    <body>
        <div class="title"><a href='https://www.egaroucid.nyanyan.dev'>オセロ研究支援AIアプリ Egaroucid</a> 使い方</div>
        <p>このアプリケーションの仕様について、不便なところや「この機能がほしい！」といった要望を募集しています。作者のTwitter(<a href='https://twitter.com/Nyanyan_Cube' target="_blank">@Nyanyan_Cube</a>または<a href='https://twitter.com/takuto_yamana' target="_blank">@takuto_yamana</a>)またはGitHubのissueやpull requestなどから要望をお送りください。</p>
        <p>&nbsp;</p>
        <h3 id='目次'>目次</h3>
        <ul>
        <li><a href='#folder'>フォルダ構成</a></li>
        <li><a href='#battle'>対局</a></li>
        <li><a href='#depth'>読み手数</a></li>
        <li><a href='#hint'>ヒント表示</a></li>
        <li><a href='#value'>評価値/グラフ表示</a></li>
        <li><a href='#analyze'>棋譜解析</a></li>
        <li><a href='#history'>履歴</a></li>
        <li><a href='#inout'>入出力</a></li>
        <li><a href='#book'>book</a></li>
        <li><a href='#joseki'>定石</a></li>

        </ul>
        <p>&nbsp;</p>
        <p><a id="folder"></a></p>
        <h3 id='フォルダ構成'>フォルダ構成</h3>
        <p>アプリの実行前に以下のフォルダとファイルがあるかを確認してください。</p>
        <pre><code>Egaroucid5.exe
resourcesフォルダ
book.txt
joseki.txt
param.txt
settings.txt
recordフォルダ</code></pre>
        <p><code>Egaroucid5.exe</code>をダブルクリックなどで実行するとアプリが起動します。</p>
        <p>アプリは本体の他に、文字を出力するコンソール画面が起動しますが、ユーザが操作することはありません。気にしないでください。探索中などに色々出力されます。</p>
        <p><a id="battle"></a></p>
        <h3 id='対局'>対局</h3>
        <p>最初に手番を<code>人間先手/人間後手/人間同士/AI同士</code>から選びます。この項目は対局中に変更ができません。</p>
        <p>ヒント表示や評価値表示、読み手数、book誤差は対局中に変更できます。</p>
        <p>設定が完了したら<code>対局開始</code>ボタンを押すと対局が開始されます。</p>
        <p><a id="depth"></a></p>
        <h3 id='読み手数'>読み手数</h3>
        <p>読み手数は<code>中盤N手読み/終盤N空読み</code>のスライドバーで設定できます。</p>
        <p>読み手数には、中盤の読み手数と終盤に完全読みする空きマス数の2種類あります。</p>
        <h4 id='中盤読み手数'>中盤読み手数</h4>
        <p>中盤の読み手数はその名前の通り、中盤に何手読むかを決める値です。</p>
        <p>前向きな枝刈り(Multi Prob Cut)の確証(どれくらいの確証で読みを早く打ち切るか)は読み手数によって以下のように決まります。確証が高いほど正確な探索になり、100%は前向きな枝刈りをしません。</p>
        <figure><table>
        <thead>
        <tr><th>読み手数</th><th>確証</th></tr></thead>
        <tbody><tr><td>[1, 10]</td><td>100%</td></tr><tr><td>[11, 12]</td><td>97.7%</td></tr><tr><td>[13, 14]</td><td>95.5%</td></tr><tr><td>[15, 16]</td><td>93.3%</td></tr><tr><td>[17, 18]</td><td>90.3%</td></tr><tr><td>[19, 20]</td><td>86.4%</td></tr><tr><td>[21, 22]</td><td>78.8%</td></tr><tr><td>[23, 60]</td><td>72.5%</td></tr></tbody>
        </table></figure>
        <h4 id='終盤空読み'>終盤空読み</h4>
        <p>終盤に完全読みに入る残り空きマス数を決める値です。</p>
        <p>前向きな枝刈り(Multi Prob Cut)の確証(どれくらいの確証で読みを早く打ち切るか)は空きマス数によって以下のように決まります。確証が高いほど正確な探索になり、100%は前向きな枝刈りをしません。</p>
        <figure><table>
        <thead>
        <tr><th>読み手数</th><th>確証</th></tr></thead>
        <tbody><tr><td>[1, 20]</td><td>100%</td></tr><tr><td>[21, 22]</td><td>99.4%</td></tr><tr><td>[23, 24]</td><td>93.3%</td></tr><tr><td>[25, 26]</td><td>86.4%</td></tr><tr><td>[27, 28]</td><td>84.1%</td></tr><tr><td>[29, 30]</td><td>81.6%</td></tr><tr><td>[31, 32]</td><td>78.8%</td></tr><tr><td>[33, 60]</td><td>75.8%</td></tr></tbody>
        </table></figure>
        <p><a id="hint"></a></p>
        <h3 id='ヒント表示'>ヒント表示</h3>
        <p>ヒント表示は局面に存在するすべての合法手に対して行われます。</p>
        <p>book登録局面の場合は評価値と<code>book</code>という表示がされます。bookに登録されていない局面はその場で何手か読んで、評価値と読み手数を表示します。ヒント表示の読み手数は<code>ヒント中盤N手読み/ヒント終盤N空読み</code>のスライドバーで設定できます。読み手数の内部仕様は上記と同じです。</p>
        <p><a id="value"></a></p>
        <h3 id='評価値グラフ表示'>評価値/グラフ表示</h3>
        <p><code>評価値表示</code>モードにすると、<strong>AIが手を選択した場合</strong>に画面中央下に評価値が表示され、画面右の評価値グラフが更新されます。AIが手を選択した場合にしか評価値は表示されません。人間が打った手の評価値を表示したいときには<code>棋譜解析</code>ボタンを押してください。</p>
        <h4 id='評価値'>評価値</h4>
        <p>画面中央下に表示される評価値はAI目線の評価値で、双方が最善手を打った場合の最終石差を表します。正の値ならAI有利、負の値ならAI不利と判断しています。</p>
        <h4 id='評価値グラフ'>評価値グラフ</h4>
        <p>評価値グラフは上に行くほど黒優勢、0が互角、下に行くほど白優勢です。双方が最善手を打った場合の予想最終石差を表します。</p>
        <p><a id="analyze"></a></p>
        <h3 id='棋譜解析'>棋譜解析</h3>
        <p>棋譜解析機能は<code>中盤N手読み/終盤N空読み</code>で設定された読み手数において棋譜のすべての手の評価値を算出し、グラフに描画します。</p>
        <p><a id="history"></a></p>
        <h3 id='履歴'>履歴</h3>
        <p>対局中または対局終了後には、画面中央下に<code>&lt;</code>と<code>&gt;</code>のボタンが現れます。このボタンを押すことで、手を戻したり進めたりできます。ただし、表示される局面は閲覧専用で、そこから手を進めることはできません</p>
        <p>実装が面倒なのでこういう仕様ですが、具体的な要望があったら仕様を変更するかもしれません。</p>
        <p><a id="inout"></a></p>
        <h3 id='入出力'>入出力</h3>
        <p>画面左下のボタンは入出力に関係するボタンです。</p>
        <p>&nbsp;</p>
        <h4 id='棋譜入力'>棋譜入力</h4>
        <p><code>棋譜入力</code>ボタンを押すと、クリップボードにある棋譜を読み込みます。棋譜はF5D6形式、またはf5d6形式に対応しています。</p>
        <p>棋譜の読み込みに成功すると<code>取得成功</code>、失敗すると<code>取得失敗</code>と表示されます。</p>
        <p>棋譜を読み込んだら<code>対局開始</code>ボタンを押すとその局面から対局できます。</p>
        <p>&nbsp;</p>
        <h4 id='局面入力'>局面入力</h4>
        <p><code>局面入力</code>ボタンを押すと、クリップボードにある局面を読み込みます。局面は<code>0</code>が黒石(先手)、<code>1</code>が白石(後手)、<code>.</code>が空きマスとして、盤面を1行で表した64文字に、その局面から打つ手番(<code>0</code>か<code>1</code>)を加えた65文字に対応しています。例えば、f5d6と縦取りした局面であれば以下となります。</p>
        <pre><code>...........................10......100.....1....................0</code></pre>
        <p>局面の読み込みに成功すると<code>取得成功</code>、失敗すると<code>取得失敗</code>と表示されます。</p>
        <p>局面を読み込んだら<code>対局開始</code>ボタンを押すとその局面から対局できます。</p>
        <p>局面入力の場合は棋譜データが存在しないので、入力された局面よりも前の局面を履歴から参照することはできません。</p>
        <p>&nbsp;</p>
        <h4 id='対局保存'>対局保存</h4>
        <p>対局中、または対局終了後に<code>対局保存</code>ボタンを押すと、現在の対局を保存できます。</p>
        <p>保存先はこのアプリがあるところにある<code>record</code>フォルダです。</p>
        <p>ファイルはテキストファイルで、名称は以下の通りです。</p>
        <pre><code>yyyymmdd_hhmmss_N_M_X.txt
yyyy: 年
mm: 月
dd: 日
hh: 時(24時間表記)
mm: 分
ss: 秒
N: AIの中盤読み手数
M: AIの終盤空読み手数
X: モード(0:人間先手 1:人間後手 2:人間同士 3:AI同士)</code></pre>
        <p>ファイルの中身は以下の形式です。</p>
        <pre><code>f5d6形式の棋譜 黒の石数 白の石数 黒から見たスコア</code></pre>
        <p>スコアについては、終局前に保存された棋譜には<code>?</code>と表示されます。</p>
        <p>保存に成功すると<code>成功</code>、失敗すると<code>失敗</code>と表示されます。</p>
        <p>&nbsp;</p>
        <h4 id='棋譜コピー'>棋譜コピー</h4>
        <p>対局中または対局終了後に<code>棋譜コピー</code>ボタンを押すと、棋譜がf5d6形式でクリップボードにコピーされます。任意の場所に貼り付けて使ってください。</p>
        <p>なお、盤面を<code>&lt;</code>や<code>&gt;</code>ボタンを使って最後の局面ではない局面に戻していても、コピーされる棋譜は最後の局面までの棋譜です。</p>
        <p>これも実装がだるくてこの仕様にしていますが、具体的な要望があれば変更します。</p>
        <p>&nbsp;</p>
        <p><a id="book"></a></p>
        <h3 id='book'>book</h3>
        <h4 id='手の選択におけるbookの使い方'>手の選択におけるbookの使い方</h4>
        <p>AIが次の一手を選択する際、 その局面での合法手に一つでもbook登録手があった場合には探索は行わず、必ずbookに登録された手を打ちます。</p>
        <p>つまり、bookに悪い手ばかり登録すると、AIは悪い手ばかりを打つようになるということです。bookには必ず良い手から順番に登録する必要があります。</p>
        <p>bookに登録されている手から、book誤差の成約(この直下で詳しく解説します)のもと、ランダムに手を選択します。</p>
        <p>&nbsp;</p>
        <h4 id='book誤差'>book誤差</h4>
        <p>book誤差は、ある局面において複数の手がbookに登録されているときに有効になります。</p>
        <p>ある局面からbookに登録された手のうち、最大の評価値をX、book誤差をYとすると、「X-Y」までの評価値の手をランダムに選びます。</p>
        <p>例えばある局面からA、B、Cという3つのbookに登録されている手が選べて、それぞれの評価値が1、-2、-10だったとします。このとき、book誤差が2以下であれば、Aのみが選ばれます。book誤差が3から10までなら、AかBが選ばれます。book誤差が11以上であれば、A、B、Cすべてのうちどれかが選ばれます。</p>
        <p>&nbsp;</p>
        <h4 id='bookの手動による修正・追加'>bookの手動による修正・追加</h4>
        <p>修正したい局面にセットして、修正したいマスを右クリックします。これでbook修正・追加モードに入ります。</p>
        <p>数字キーまたはテンキー(テンキーは動作未確認)とマイナス符号<code>-</code>とバックスペースキーを使って修正した評価値を入力してください。入力の確認のため、画面右下に入力した値が出ます。同じマスを再び右クリックすると新しい評価値がbookに登録されます。</p>
        <p>入力された文字列が整数に変換できなかった場合は「形式エラー」と表示されます。</p>
        <p>誤ってbook修正・追加モードに入ってしまった場合は何も入力せずに(入力欄が空の状態で)同じマスを右クリックすると抜けられます。</p>
        <p>bookが変更された場合、アプリの閉じるボタンを押したときにbookを保存するか聞かれます。誤ってbookを登録したときには<code>保存しない</code>ボタンを押してください。</p>
        <p>誤ってbookを登録して保存してしまった場合は手動で戻すか、resourcesフォルダの<code>book_backup.txt</code>を<code>book.txt</code>にリネームしてください。</p>
        <p>&nbsp;</p>
        <h4 id='bookの自動学習'>bookの自動学習</h4>
        <p>まず、bookを生成し始めたい根となる局面に設定して<code>対局開始</code>ボタンを押します。または、人間同士の設定で対局を開始し、指定局面に設定してください。</p>
        <p>bookの学習には<code>中盤N手読み/終盤N空読み</code>で設定した先読み手数が使われます。学習開始後には再設定できませんので、ここで設定してください。この状態で<code>book学習</code>ボタンを押すとbookの自動生成が開始されます。</p>
        <p>学習を開始すると<code>book学習</code>ボタンが<code>学習停止</code>ボタンに変わります。<code>学習停止</code>ボタンを押すといつでも学習を停止できます。</p>
        <p>bookを学習しただけでは新しいbookは保存されません。アプリの閉じるボタンを押すとbookを保存するかの確認が出るので、保存する場合は<code>保存する</code>ボタンを押してください。</p>
        <h5 id='book自動生成アルゴリズムの解説'>book自動生成アルゴリズムの解説</h5>
        <p>bookは指定された局面を指定された手数だけ先読みすることで評価値を計算します。</p>
        <p>簡単にアルゴリズムの意図を解説すると、有力な進行から順番に評価値を計算していくというものです。</p>
        <p>実装には優先度付きキューを使っていて、以下のアルゴリズムで動いています。</p>
        <ol start='' >
        <li>最初に設定された根となる局面をまずキューに追加します。</li>
        <li>以下をキューが空になるまで繰り返します。</li>
        <li>キューの先頭から局面を取り出します。このときキューから取り出される局面は、根の局面から現在の局面までの評価値の絶対値の和とその盤面の石数の和が一番小さいものです。</li>
        <li>局面からの全ての合法手に対して以下を行います。</li>
        <li>局面から1手進めて、評価値を決められた深さで計算し、bookに追加します。</li>
        <li>キューに局面を追加します。</li>

        </ol>
        <p>&nbsp;</p>
        <h4 id='bookの統合'>bookの統合</h4>
        <p>本アプリの形式で作られた複数のbookはアプリ上で統合できます。なお、複数のbookにおいて同じ局面に違う値が入っていた場合は、後に統合されたbookの値が採用されます。</p>
        <p>まず、統合元(重複があったら値が塗り替えられる方)のbookを1つ<code>resources</code>フォルダに<code>book.txt</code>という名前で置きます。統合先(重複があったら値が採用される方)のbookは適当な場所に適当な名前で置いておきます。</p>
        <p>本アプリを起動し、統合先のbookをアプリの画面上にドラッグ&amp;ドロップしてください。これで統合が完了します。なお、ドラッグ&amp;ドロップは一度に1つのファイルしか行えません。複数のファイルを一気にドラッグ&amp;ドロップすると、最初の一つのbookしか統合されません。1つのファイルであれば何回でもドラッグ&amp;ドロップできるので、順番に行ってください。</p>
        <p>統合しただけではbookは保存されません。アプリの閉じるボタンを押すとbookを保存するか聞かれるので、保存する場合は<code>保存する</code>ボタンを押してください。</p>
        <p>&nbsp;</p>
        <h4 id='bookファイルのフォーマット'>bookファイルのフォーマット</h4>
        <p>bookファイルは単なるテキストファイルですので、外部ツールを自作して簡単に改変できます。</p>
        <p>bookファイルは1行が1つの盤面と対応していて、各行は以下のようになっています。</p>
        <pre><code>..........1.......11......1011.....00.......0................... 0 5</code></pre>
        <p>スペースで区切ったとき、最初の要素は盤面を表しています。盤面の64マスを、<code>0</code>を黒(先手)、<code>1</code>を白(後手)、<code>.</code>を空きマスとして左上から並べて表します。</p>
        <p>2つ目の要素はその盤面から打つ手番を表します。<code>0</code>が黒、<code>1</code>が白です。</p>
        <p>3つ目の要素は黒目線の評価値(予想最終石差)です。</p>
        <p>対称形の盤面は省略してあります。</p>
        <p>&nbsp;</p>
        <h4 id='標準付属bookの仕様'>標準付属bookの仕様</h4>
        <p>このアプリには標準で作者が生成したbookが付属しています。このbookは以下の仕様で作られたものです。</p>
        <ul>
        <li>中盤33手読み</li>
        <li>終盤33手読み</li>
        <li>初手から生成</li>
        <li>作者が手動で微修正</li>

        </ul>
        <p>&nbsp;</p>
        <p><a id="joseki"></a></p>
        <h3 id='定石'>定石</h3>
        <p>画面中央上に定石名が表示できる場合は表示されます。</p>
        <p>定石データはこちらのものを使っています: <a href='http://evaccaneer.livedoor.blog/archives/11101657.html' target='_blank' class='url'>http://evaccaneer.livedoor.blog/archives/11101657.html</a></p>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.js"></script>
    </body>
</html>